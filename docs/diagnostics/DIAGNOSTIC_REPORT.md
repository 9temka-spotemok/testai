# üìä –û—Ç—á—ë—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–î–∞—Ç–∞:** 2025-11-14  
**–°—Ç–∞—Ç—É—Å:** üî¥ –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
   - ‚úÖ Redis –¥–æ—Å—Ç—É–ø–µ–Ω (PONG)
   - ‚úÖ PostgreSQL —Ä–∞–±–æ—Ç–∞–µ—Ç (healthy)
   - ‚úÖ Celery worker –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ Celery worker —Å–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥–∏: `celery,analytics`
   - ‚úÖ Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—Ä—Ç 8000)

2. **–î–∞–Ω–Ω—ã–µ –≤ –ë–î:**
   - ‚úÖ 131 –∫–æ–º–ø–∞–Ω–∏—è –≤ –±–∞–∑–µ
   - ‚úÖ –ï—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 71 –Ω–æ–≤–æ—Å—Ç—å –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ `75eee989-a419-4220-bdc6-810c4854a1fe`)

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–ù–æ–≤–æ—Å—Ç–∏ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã NLP**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –£ **–≤—Å–µ—Ö** –Ω–æ–≤–æ—Å—Ç–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–æ–ª—è:
  - `sentiment = NULL` (0 –Ω–æ–≤–æ—Å—Ç–µ–π —Å sentiment)
  - –í–µ—Ä–æ—è—Ç–Ω–æ, —Ç–∞–∫–∂–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç `priority_score` –∏ `topic`

**–í–ª–∏—è–Ω–∏–µ:**
- Snapshot –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω —Å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- `news_average_sentiment` –±—É–¥–µ—Ç 0
- `news_average_priority` –±—É–¥–µ—Ç 0
- Impact score –±—É–¥–µ—Ç –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–º –∏–ª–∏ 0

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å NLP –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π
# –ß–µ—Ä–µ–∑ Celery –∑–∞–¥–∞—á—É –∏–ª–∏ API endpoint
```

### 2. **–ù–µ—Ç snapshots –≤ –ë–î**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í —Ç–∞–±–ª–∏—Ü–µ `company_analytics_snapshots` **0 –∑–∞–ø–∏—Å–µ–π**
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–µ—Å—á—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è —É—Å–ø–µ—à–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:**
- –õ–∏–±–æ –∑–∞–¥–∞—á–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å
- –õ–∏–±–æ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å —Å –æ—à–∏–±–∫–∞–º–∏
- –õ–∏–±–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è snapshots

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏

**Company ID:** `75eee989-a419-4220-bdc6-810c4854a1fe`

**–ù–æ–≤–æ—Å—Ç–∏:**
- –í—Å–µ–≥–æ: 71
- –° sentiment: **0** ‚ùå
- –° priority_score: –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
- –° topic: –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

**Change Events:**
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∞—Ç—É—Å

**Snapshots:**
- Daily: **0** ‚ùå
- Weekly: **0** ‚ùå
- Monthly: **0** ‚ùå

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ NLP

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Celery –∑–∞–¥–∞—á—É (–µ—Å–ª–∏ –µ—Å—Ç—å)
celery -A app.celery_app call app.tasks.nlp.classify_news_batch

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ API (–µ—Å–ª–∏ –µ—Å—Ç—å endpoint)
POST /api/v1/news/process-nlp
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ—Å—á—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

```bash
# –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
POST /api/v2/analytics/companies/75eee989-a419-4220-bdc6-810c4854a1fe/recompute?period=daily&lookback=60
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ snapshot
GET /api/v2/analytics/companies/75eee989-a419-4220-bdc6-810c4854a1fe/impact/latest?period=daily
```

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Celery worker
docker exec shot-news-celery-worker celery -A app.celery_app inspect active

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ —Å NLP –¥–∞–Ω–Ω—ã–º–∏
docker exec shot-news-postgres psql -U shot_news -d shot_news -c "
SELECT COUNT(*) as total,
       COUNT(CASE WHEN sentiment IS NOT NULL THEN 1 END) as with_sentiment,
       COUNT(CASE WHEN priority_score IS NOT NULL THEN 1 END) as with_priority
FROM news_items 
WHERE company_id = '75eee989-a419-4220-bdc6-810c4854a1fe';"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å snapshots
docker exec shot-news-postgres psql -U shot_news -d shot_news -c "
SELECT period, COUNT(*), MAX(period_start) 
FROM company_analytics_snapshots 
WHERE company_id = '75eee989-a419-4220-bdc6-810c4854a1fe'
GROUP BY period;"

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Celery –Ω–∞ –æ—à–∏–±–∫–∏
docker logs shot-news-celery-worker --tail=100 | grep -i error
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

**–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:**
1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–æ–≤–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã NLP (–µ—Å—Ç—å `sentiment`, `priority_score`, `topic`)
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å change events —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `SUCCESS` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Celery worker –∑–∞–ø—É—â–µ–Ω –∏ —Å–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å `analytics`

**–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø–µ—Ä–µ—Å—á—ë—Ç–∞:**
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 5-10 —Å–µ–∫—É–Ω–¥
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Celery worker –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ snapshots –≤ –ë–î
4. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ




