# üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–î–∞—Ç–∞:** 2025-11-14 16:40  
**–ö–æ–º–ø–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** `75eee989-a419-4220-bdc6-810c4854a1fe`

## ‚úÖ –°—Ç–∞—Ç—É—Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|--------|
| Redis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | PONG - –¥–æ—Å—Ç—É–ø–µ–Ω |
| PostgreSQL | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | Healthy - 131 –∫–æ–º–ø–∞–Ω–∏—è |
| Celery Worker | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥–∏ `celery,analytics` |
| Celery Beat | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω |
| Backend API | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ—Ä—Ç 8000 |
| Celery –∑–∞–¥–∞—á–∏ | ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã | `recompute_company_analytics` –¥–æ—Å—Ç—É–ø–Ω–∞ |

## üìä –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–º–ø–∞–Ω–∏—è: `75eee989-a419-4220-bdc6-810c4854a1fe`

**–ù–æ–≤–æ—Å—Ç–∏:**
- –í—Å–µ–≥–æ: **71**
- –° `priority_score`: **71** (100%) ‚úÖ
- –° `sentiment`: **0** ‚Üí –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
- –° `topic`: **0** ‚Üí –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è —á–∞—Å—Ç–∏—á–Ω–æ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è)

**Change Events:**
- –í—Å–µ–≥–æ: **0**
- –°–æ —Å—Ç–∞—Ç—É—Å–æ–º SUCCESS: **0**
- ‚ö†Ô∏è –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤

**Snapshots:**
- Daily: **0** ‚ùå
- Weekly: **0** ‚ùå
- Monthly: **0** ‚ùå

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

### 1. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π NLP
- –§–∞–π–ª: `backend/scripts/process_company_news_nlp.py`
- –§—É–Ω–∫—Ü–∏—è: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏, –¥–æ–±–∞–≤–ª—è—è `sentiment`, `topic`, `priority_score`

### 2. –ó–∞–ø—É—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 10 –Ω–æ–≤–æ—Å—Ç–µ–π
- –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã `sentiment` –∏ –æ–±–Ω–æ–≤–ª—ë–Ω `priority_score`

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –®–∞–≥ 1: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏

```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏
docker exec shot-news-backend python -m scripts.process_company_news_nlp 75eee989-a419-4220-bdc6-810c4854a1fe
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –í—Å–µ 71 –Ω–æ–≤–æ—Å—Ç—å –ø–æ–ª—É—á–∞—Ç `sentiment` (neutral/positive/negative/mixed)
- –ß–∞—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ–ª—É—á–∏—Ç `topic` (–µ—Å–ª–∏ —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞)
- `priority_score` –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω —Å —É—á—ë—Ç–æ–º sentiment –∏ topic

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ—Å—á—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–ß–µ—Ä–µ–∑ UI:**
1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É Competitor Analysis
2. –í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º "Company Analysis"
3. –í—ã–±—Ä–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—é
4. –ù–∞–∂–∞—Ç—å "Analyze Company"
5. –ù–∞–∂–∞—Ç—å "Recompute" –≤ ImpactPanel

**–ß–µ—Ä–µ–∑ API:**
```bash
POST /api/v2/analytics/companies/75eee989-a419-4220-bdc6-810c4854a1fe/recompute?period=daily&lookback=60
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–æ–∑–¥–∞–¥—É—Ç—Å—è snapshots –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 60 –¥–Ω–µ–π
- Impact score –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π
- –î–∞–Ω–Ω—ã–µ –ø–æ—è–≤—è—Ç—Å—è –≤ UI —á–µ—Ä–µ–∑ 5-10 —Å–µ–∫—É–Ω–¥

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ snapshots
GET /api/v2/analytics/companies/75eee989-a419-4220-bdc6-810c4854a1fe/impact/latest?period=daily

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î
docker exec shot-news-postgres psql -U shot_news -d shot_news -c "
SELECT period, COUNT(*), MAX(period_start), AVG(impact_score)
FROM company_analytics_snapshots 
WHERE company_id = '75eee989-a419-4220-bdc6-810c4854a1fe'
GROUP BY period;"
```

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Topic –æ—Å—Ç–∞—ë—Ç—Å—è NULL
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏  
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, topic –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω. Snapshot —Å–æ–∑–¥–∞—Å—Ç—Å—è –±–µ–∑ topic.

### 2. Impact score = 0
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç change events –∏–ª–∏ –æ—á–µ–Ω—å –º–∞–ª–æ –Ω–æ–≤–æ—Å—Ç–µ–π  
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. Impact score –±—É–¥–µ—Ç –Ω–∏–∑–∫–∏–º.

### 3. Snapshot –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å—á—ë—Ç–∞
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –õ–æ–≥–∏ Celery worker: `docker logs shot-news-celery-worker --tail=50`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤–æ—Å—Ç–µ–π
docker exec shot-news-postgres psql -U shot_news -d shot_news -c "
SELECT COUNT(*) as total,
       COUNT(CASE WHEN sentiment IS NOT NULL THEN 1 END) as with_sentiment,
       COUNT(CASE WHEN topic IS NOT NULL THEN 1 END) as with_topic
FROM news_items 
WHERE company_id = '75eee989-a419-4220-bdc6-810c4854a1fe';"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å snapshots
docker exec shot-news-postgres psql -U shot_news -d shot_news -c "
SELECT period, COUNT(*), MAX(period_start) as latest
FROM company_analytics_snapshots 
WHERE company_id = '75eee989-a419-4220-bdc6-810c4854a1fe'
GROUP BY period;"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Celery
docker logs shot-news-celery-worker --tail=50 | grep -i "analytics\|recompute\|error"
```

## ‚úÖ –ò—Ç–æ–≥

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ  
**–î–∞–Ω–Ω—ã–µ:** –ï—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–∏, –Ω–æ —Ç—Ä–µ–±—É—é—Ç NLP –æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚ö†Ô∏è  
**Snapshots:** –ù–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å—á—ë—Ç ‚ùå  

**–î–µ–π—Å—Ç–≤–∏—è:**
1. ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
2. ‚è≥ –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏
3. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ—Å—á—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
4. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ UI

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –ø–µ—Ä–µ—Å—á—ë—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.




